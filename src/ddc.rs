use num::Complex;

pub use crate::{
    bindings::{self, fcomplex, DDCResources, DDCResources2},
    payload::N_PT_PER_FRAME,
};
use std::os::raw::c_int;

unsafe impl Send for fcomplex{}
unsafe impl Sync for fcomplex{}
pub const M: usize=8192;

pub struct DownConverter (pub DDCResources);

impl DownConverter {
    pub fn new(ndec: usize, fir_coeffs: &[f32]) -> Self {
        let k = fir_coeffs.len() / ndec;
        assert_eq!(ndec * k, fir_coeffs.len());

        let mut res = DDCResources {
            d_indata: std::ptr::null_mut(),
            K: k as i32,
            N: N_PT_PER_FRAME as i32,
            M: M as i32,
            NDEC: ndec as i32,
            d_fir_coeffs: std::ptr::null_mut(),
            d_outdata: std::ptr::null_mut(),
            gpu_buffer: std::ptr::null_mut(),
            h_indata: std::ptr::null_mut(),
            h_index: 0,
        };
        unsafe {
            crate::bindings::init_ddc_resources(
                (&mut res) as *mut DDCResources,
                N_PT_PER_FRAME as i32,
                M as i32,
                ndec as c_int,
                k as c_int,
                fir_coeffs.as_ptr(),
            );
        }

        Self(res)
    }

    pub fn ddc(&mut self, indata: &[i16], lo_ch: isize) -> bool {
        assert_eq!(indata.len(), N_PT_PER_FRAME);

        let result = unsafe {
            bindings::ddc(
                indata.as_ptr(),
                lo_ch as c_int,
                (&mut self.0) as *mut DDCResources,
            )
        };
        assert!(result >= 0);
        result != 0
    }

    pub fn fetch_output(&mut self, outdata: &mut [Complex<f32>]) {
        assert_eq!(outdata.len(), self.n_out_data());
        unsafe {
            bindings::fetch_output(
                outdata.as_mut_ptr() as *mut fcomplex,
                (&mut self.0) as *mut DDCResources,
            )
        }
    }

    pub fn n_out_data(&self) -> usize {
        unsafe { bindings::calc_output_size((&self.0) as * const DDCResources) as usize }
    }
}

impl Drop for DownConverter {
    fn drop(&mut self) {
        unsafe { crate::bindings::free_ddc_resources((&mut self.0) as *mut DDCResources) };
    }
}


pub struct DownConverter2(pub DDCResources2);

impl DownConverter2 {
    pub fn new(ndec: usize, fir_coeffs: &[f32], n: usize) -> Self {
        let k = fir_coeffs.len() / ndec;
        assert_eq!(ndec * k, fir_coeffs.len());

        let mut res = DDCResources2 {
            d_indata: std::ptr::null_mut(),
            K: k as i32,
            N: n as i32,
            NDEC: ndec as i32,
            d_fir_coeffs: std::ptr::null_mut(),
            d_outdata: std::ptr::null_mut(),
            gpu_buffer: std::ptr::null_mut(),
        };
        unsafe {
            crate::bindings::init_ddc_resources2(
                (&mut res) as *mut DDCResources2,
                n as i32,
                ndec as c_int,
                k as c_int,
                fir_coeffs.as_ptr(),
            );
        }

        Self(res)
    }

    pub fn ddc(&mut self, indata: *const fcomplex, lo_ch: isize) {
        //assert_eq!(indata.len(), N_PT_PER_FRAME);

        let result = unsafe {
            bindings::ddc2(
                indata,
                lo_ch as c_int,
                (&mut self.0) as *mut DDCResources2,
            )
        };
        assert!(result >= 0);
    }

    pub fn fetch_output(&mut self, outdata: &mut [Complex<f32>]) {
        assert_eq!(outdata.len(), self.n_out_data());
        unsafe {
            bindings::fetch_output2(
                outdata.as_mut_ptr() as *mut fcomplex,
                (&mut self.0) as *mut DDCResources2,
            )
        }
    }

    pub fn n_out_data(&self) -> usize {
        unsafe { bindings::calc_output_size2((&self.0) as * const DDCResources2) as usize }
    }
}

impl Drop for DownConverter2 {
    fn drop(&mut self) {
        unsafe { crate::bindings::free_ddc_resources2((&mut self.0) as *mut DDCResources2) };
    }
}



pub fn fir_coeffs1() -> Vec<f32> {
    vec![
        -8.30829935e-05,
        -1.00714599e-04,
        -1.17997389e-04,
        -1.34282160e-04,
        -1.48821308e-04,
        -1.60767935e-04,
        -1.69176312e-04,
        -1.73003787e-04,
        -1.71114210e-04,
        -1.62282942e-04,
        -1.45203459e-04,
        -1.18495597e-04,
        -8.07153875e-05,
        -3.03664859e-05,
        3.40868919e-05,
        1.14205597e-04,
        2.11559855e-04,
        3.27712375e-04,
        4.64200435e-04,
        6.22517104e-04,
        8.04091808e-04,
        1.01027046e-03,
        1.24229535e-03,
        1.50128515e-03,
        1.78821509e-03,
        2.10389778e-03,
        2.44896483e-03,
        2.82384948e-03,
        3.22877068e-03,
        3.66371865e-03,
        4.12844236e-03,
        4.62243896e-03,
        5.14494559e-03,
        5.69493352e-03,
        6.27110495e-03,
        6.87189251e-03,
        7.49546162e-03,
        8.13971567e-03,
        8.80230422e-03,
        9.48063398e-03,
        1.01718828e-02,
        1.08730165e-02,
        1.15808079e-02,
        1.22918593e-02,
        1.30026263e-02,
        1.37094443e-02,
        1.44085572e-02,
        1.50961464e-02,
        1.57683630e-02,
        1.64213591e-02,
        1.70513210e-02,
        1.76545022e-02,
        1.82272565e-02,
        1.87660701e-02,
        1.92675941e-02,
        1.97286744e-02,
        2.01463811e-02,
        2.05180355e-02,
        2.08412357e-02,
        2.11138784e-02,
        2.13341797e-02,
        2.15006913e-02,
        2.16123148e-02,
        2.16683120e-02,
        2.16683120e-02,
        2.16123148e-02,
        2.15006913e-02,
        2.13341797e-02,
        2.11138784e-02,
        2.08412357e-02,
        2.05180355e-02,
        2.01463811e-02,
        1.97286744e-02,
        1.92675941e-02,
        1.87660701e-02,
        1.82272565e-02,
        1.76545022e-02,
        1.70513210e-02,
        1.64213591e-02,
        1.57683630e-02,
        1.50961464e-02,
        1.44085572e-02,
        1.37094443e-02,
        1.30026263e-02,
        1.22918593e-02,
        1.15808079e-02,
        1.08730165e-02,
        1.01718828e-02,
        9.48063398e-03,
        8.80230422e-03,
        8.13971567e-03,
        7.49546162e-03,
        6.87189251e-03,
        6.27110495e-03,
        5.69493352e-03,
        5.14494559e-03,
        4.62243896e-03,
        4.12844236e-03,
        3.66371865e-03,
        3.22877068e-03,
        2.82384948e-03,
        2.44896483e-03,
        2.10389778e-03,
        1.78821509e-03,
        1.50128515e-03,
        1.24229535e-03,
        1.01027046e-03,
        8.04091808e-04,
        6.22517104e-04,
        4.64200435e-04,
        3.27712375e-04,
        2.11559855e-04,
        1.14205597e-04,
        3.40868919e-05,
        -3.03664859e-05,
        -8.07153875e-05,
        -1.18495597e-04,
        -1.45203459e-04,
        -1.62282942e-04,
        -1.71114210e-04,
        -1.73003787e-04,
        -1.69176312e-04,
        -1.60767935e-04,
        -1.48821308e-04,
        -1.34282160e-04,
        -1.17997389e-04,
        -1.00714599e-04,
        -8.30829935e-05,
    ]
}

pub fn fir_coeffs2() -> Vec<f32> {
    vec![
        1.24919278e-04,
        1.87340062e-04,
        2.54336466e-04,
        3.19419542e-04,
        3.74655087e-04,
        4.11165271e-04,
        4.19813565e-04,
        3.92038171e-04,
        3.20780621e-04,
        2.01440077e-04,
        3.27717133e-05,
        -1.82358899e-04,
        -4.36453212e-04,
        -7.17168929e-04,
        -1.00748549e-03,
        -1.28628744e-03,
        -1.52937838e-03,
        -1.71090455e-03,
        -1.80513157e-03,
        -1.78848233e-03,
        -1.64171198e-03,
        -1.35207001e-03,
        -9.15281892e-04,
        -3.37176770e-04,
        3.65206597e-04,
        1.16318370e-03,
        2.01677387e-03,
        2.87590733e-03,
        3.68250762e-03,
        4.37340718e-03,
        4.88399089e-03,
        5.15240109e-03,
        5.12408244e-03,
        4.75640038e-03,
        4.02303662e-03,
        2.91785302e-03,
        1.45792206e-03,
        -3.14549107e-04,
        -2.33162605e-03,
        -4.50054372e-03,
        -6.70616835e-03,
        -8.81500806e-03,
        -1.06806578e-02,
        -1.21504677e-02,
        -1.30731356e-02,
        -1.33068463e-02,
        -1.27275284e-02,
        -1.12367619e-02,
        -8.76886842e-03,
        -5.29673644e-03,
        -8.35986530e-04,
        4.55284086e-03,
        1.07642930e-02,
        1.76503082e-02,
        2.50247886e-02,
        3.26702858e-02,
        4.03465187e-02,
        4.78003304e-02,
        5.47766012e-02,
        6.10295684e-02,
        6.63339694e-02,
        7.04954233e-02,
        7.33595010e-02,
        7.48189943e-02,
        7.48189943e-02,
        7.33595010e-02,
        7.04954233e-02,
        6.63339694e-02,
        6.10295684e-02,
        5.47766012e-02,
        4.78003304e-02,
        4.03465187e-02,
        3.26702858e-02,
        2.50247886e-02,
        1.76503082e-02,
        1.07642930e-02,
        4.55284086e-03,
        -8.35986530e-04,
        -5.29673644e-03,
        -8.76886842e-03,
        -1.12367619e-02,
        -1.27275284e-02,
        -1.33068463e-02,
        -1.30731356e-02,
        -1.21504677e-02,
        -1.06806578e-02,
        -8.81500806e-03,
        -6.70616835e-03,
        -4.50054372e-03,
        -2.33162605e-03,
        -3.14549107e-04,
        1.45792206e-03,
        2.91785302e-03,
        4.02303662e-03,
        4.75640038e-03,
        5.12408244e-03,
        5.15240109e-03,
        4.88399089e-03,
        4.37340718e-03,
        3.68250762e-03,
        2.87590733e-03,
        2.01677387e-03,
        1.16318370e-03,
        3.65206597e-04,
        -3.37176770e-04,
        -9.15281892e-04,
        -1.35207001e-03,
        -1.64171198e-03,
        -1.78848233e-03,
        -1.80513157e-03,
        -1.71090455e-03,
        -1.52937838e-03,
        -1.28628744e-03,
        -1.00748549e-03,
        -7.17168929e-04,
        -4.36453212e-04,
        -1.82358899e-04,
        3.27717133e-05,
        2.01440077e-04,
        3.20780621e-04,
        3.92038171e-04,
        4.19813565e-04,
        4.11165271e-04,
        3.74655087e-04,
        3.19419542e-04,
        2.54336466e-04,
        1.87340062e-04,
        1.24919278e-04,
    ]
}

pub fn fir_coeffs3()->Vec<f32>{
    vec![-7.52567224e-06, -3.36087203e-07, -3.02156487e-07, -2.35039363e-07,
    -1.37315456e-07, -1.65670499e-09,  1.69545575e-07,  3.84362202e-07,
     6.40157722e-07,  9.46012881e-07,  1.29864137e-06,  1.70887208e-06,
     2.17222699e-06,  2.70357144e-06,  3.29552735e-06,  3.97842068e-06,
     4.71724754e-06,  5.53421200e-06,  6.44695233e-06,  7.44095236e-06,
     8.53241106e-06,  9.71829804e-06,  1.10084312e-05,  1.24030480e-05,
     1.39097752e-05,  1.55304891e-05,  1.72715427e-05,  1.91356900e-05,
     2.11275577e-05,  2.32497674e-05,  2.55036495e-05,  2.78936549e-05,
     3.04292683e-05,  3.31004668e-05,  3.59187691e-05,  3.88804249e-05,
     4.19898561e-05,  4.52450451e-05,  4.86485019e-05,  5.21977287e-05,
     5.58936478e-05,  5.97326216e-05,  6.37139481e-05,  6.78328014e-05,
     7.20875527e-05,  7.64725159e-05,  8.09851099e-05,  8.56133789e-05,
     9.03565323e-05,  9.52039620e-05,  1.00147707e-04,  1.05178174e-04,
     1.10285229e-04,  1.15457023e-04,  1.20681679e-04,  1.25945239e-04,
     1.31234099e-04,  1.36532404e-04,  1.41824750e-04,  1.47092877e-04,
     1.52319084e-04,  1.57482521e-04,  1.62565452e-04,  1.67545339e-04,
     1.72399071e-04,  1.77105100e-04,  1.81638120e-04,  1.85973795e-04,
     1.90085937e-04,  1.93948182e-04,  1.97533037e-04,  2.00812464e-04,
     2.03757482e-04,  2.06338547e-04,  2.08525640e-04,  2.10288483e-04,
     2.11596442e-04,  2.12417879e-04,  2.12720312e-04,  2.12473874e-04,
     2.11645062e-04,  2.10202835e-04,  2.08115089e-04,  2.05350374e-04,
     2.01877203e-04,  1.97664675e-04,  1.92682169e-04,  1.86900042e-04,
     1.80289157e-04,  1.72821508e-04,  1.64469490e-04,  1.55206978e-04,
     1.45008776e-04,  1.33852391e-04,  1.21714575e-04,  1.08575385e-04,
     9.44163498e-05,  7.92202420e-05,  6.29726373e-05,  4.56606763e-05,
     2.72742968e-05,  7.80555006e-06, -1.27507819e-05, -3.43975013e-05,
    -5.71344542e-05, -8.09585042e-05, -1.05863296e-04, -1.31839424e-04,
    -1.58874677e-04, -1.86952939e-04, -2.16054156e-04, -2.46156122e-04,
    -2.77231282e-04, -3.09249577e-04, -3.42176219e-04, -3.75973195e-04,
    -4.10598025e-04, -4.46004623e-04, -4.82142287e-04, -5.18956596e-04,
    -5.56388632e-04, -5.94375874e-04, -6.32851117e-04, -6.71743196e-04,
    -7.10976245e-04, -7.50471535e-04, -7.90144587e-04, -8.29908111e-04,
    -8.69670155e-04, -9.09335148e-04, -9.48803419e-04, -9.87971642e-04,
    -1.02673261e-03, -1.06497588e-03, -1.10258733e-03, -1.13944981e-03,
    -1.17544258e-03, -1.21044225e-03, -1.24432242e-03, -1.27695455e-03,
    -1.30820682e-03, -1.33794591e-03, -1.36603636e-03, -1.39234060e-03,
    -1.41671994e-03, -1.43903406e-03, -1.45914191e-03, -1.47690158e-03,
    -1.49217071e-03, -1.50480664e-03, -1.51466686e-03, -1.52160933e-03,
    -1.52549281e-03, -1.52617695e-03, -1.52352266e-03, -1.51739270e-03,
    -1.50765200e-03, -1.49416717e-03, -1.47680827e-03, -1.45544781e-03,
    -1.42996199e-03, -1.40023045e-03, -1.36613692e-03, -1.32756939e-03,
    -1.28442071e-03, -1.23658861e-03, -1.18397624e-03, -1.12649218e-03,
    -1.06405119e-03, -9.96574229e-04, -9.23988936e-04, -8.46229396e-04,
    -7.63237466e-04, -6.74961966e-04, -5.81359511e-04, -4.82394664e-04,
    -3.78040051e-04, -2.68276881e-04, -1.53094850e-04, -3.24924552e-05,
     9.35229016e-05,  2.24934626e-04,  3.61716778e-04,  5.03834022e-04,
     6.51241583e-04,  8.03885037e-04,  9.61700116e-04,  1.12461292e-03,
     1.29253995e-03,  1.46538748e-03,  1.64305237e-03,  1.82542134e-03,
     2.01237175e-03,  2.20377106e-03,  2.39947733e-03,  2.59933891e-03,
     2.80319504e-03,  3.01087562e-03,  3.22220176e-03,  3.43698549e-03,
     3.65503044e-03,  3.87613177e-03,  4.10007675e-03,  4.32664437e-03,
     4.55560659e-03,  4.78672779e-03,  5.01976577e-03,  5.25447157e-03,
     5.49059014e-03,  5.72786059e-03,  5.96601681e-03,  6.20478762e-03,
     6.44389736e-03,  6.68306619e-03,  6.92201080e-03,  7.16044462e-03,
     7.39807847e-03,  7.63462082e-03,  7.86977873e-03,  8.10325794e-03,
     8.33476350e-03,  8.56400035e-03,  8.79067374e-03,  9.01449000e-03,
     9.23515677e-03,  9.45238371e-03,  9.66588291e-03,  9.87536956e-03,
     1.00805624e-02,  1.02811842e-02,  1.04769623e-02,  1.06676294e-02,
     1.08529234e-02,  1.10325888e-02,  1.12063761e-02,  1.13740434e-02,
     1.15353560e-02,  1.16900876e-02,  1.18380197e-02,  1.19789432e-02,
     1.21126580e-02,  1.22389737e-02,  1.23577099e-02,  1.24686966e-02,
     1.25717743e-02,  1.26667950e-02,  1.27536214e-02,  1.28321283e-02,
     1.29022019e-02,  1.29637408e-02,  1.30166556e-02,  1.30608694e-02,
     1.30963180e-02,  1.31229497e-02,  1.31407258e-02,  1.31496203e-02,
     1.31496203e-02,  1.31407258e-02,  1.31229497e-02,  1.30963180e-02,
     1.30608694e-02,  1.30166556e-02,  1.29637408e-02,  1.29022019e-02,
     1.28321283e-02,  1.27536214e-02,  1.26667950e-02,  1.25717743e-02,
     1.24686966e-02,  1.23577099e-02,  1.22389737e-02,  1.21126580e-02,
     1.19789432e-02,  1.18380197e-02,  1.16900876e-02,  1.15353560e-02,
     1.13740434e-02,  1.12063761e-02,  1.10325888e-02,  1.08529234e-02,
     1.06676294e-02,  1.04769623e-02,  1.02811842e-02,  1.00805624e-02,
     9.87536956e-03,  9.66588291e-03,  9.45238371e-03,  9.23515677e-03,
     9.01449000e-03,  8.79067374e-03,  8.56400035e-03,  8.33476350e-03,
     8.10325794e-03,  7.86977873e-03,  7.63462082e-03,  7.39807847e-03,
     7.16044462e-03,  6.92201080e-03,  6.68306619e-03,  6.44389736e-03,
     6.20478762e-03,  5.96601681e-03,  5.72786059e-03,  5.49059014e-03,
     5.25447157e-03,  5.01976577e-03,  4.78672779e-03,  4.55560659e-03,
     4.32664437e-03,  4.10007675e-03,  3.87613177e-03,  3.65503044e-03,
     3.43698549e-03,  3.22220176e-03,  3.01087562e-03,  2.80319504e-03,
     2.59933891e-03,  2.39947733e-03,  2.20377106e-03,  2.01237175e-03,
     1.82542134e-03,  1.64305237e-03,  1.46538748e-03,  1.29253995e-03,
     1.12461292e-03,  9.61700116e-04,  8.03885037e-04,  6.51241583e-04,
     5.03834022e-04,  3.61716778e-04,  2.24934626e-04,  9.35229016e-05,
    -3.24924552e-05, -1.53094850e-04, -2.68276881e-04, -3.78040051e-04,
    -4.82394664e-04, -5.81359511e-04, -6.74961966e-04, -7.63237466e-04,
    -8.46229396e-04, -9.23988936e-04, -9.96574229e-04, -1.06405119e-03,
    -1.12649218e-03, -1.18397624e-03, -1.23658861e-03, -1.28442071e-03,
    -1.32756939e-03, -1.36613692e-03, -1.40023045e-03, -1.42996199e-03,
    -1.45544781e-03, -1.47680827e-03, -1.49416717e-03, -1.50765200e-03,
    -1.51739270e-03, -1.52352266e-03, -1.52617695e-03, -1.52549281e-03,
    -1.52160933e-03, -1.51466686e-03, -1.50480664e-03, -1.49217071e-03,
    -1.47690158e-03, -1.45914191e-03, -1.43903406e-03, -1.41671994e-03,
    -1.39234060e-03, -1.36603636e-03, -1.33794591e-03, -1.30820682e-03,
    -1.27695455e-03, -1.24432242e-03, -1.21044225e-03, -1.17544258e-03,
    -1.13944981e-03, -1.10258733e-03, -1.06497588e-03, -1.02673261e-03,
    -9.87971642e-04, -9.48803419e-04, -9.09335148e-04, -8.69670155e-04,
    -8.29908111e-04, -7.90144587e-04, -7.50471535e-04, -7.10976245e-04,
    -6.71743196e-04, -6.32851117e-04, -5.94375874e-04, -5.56388632e-04,
    -5.18956596e-04, -4.82142287e-04, -4.46004623e-04, -4.10598025e-04,
    -3.75973195e-04, -3.42176219e-04, -3.09249577e-04, -2.77231282e-04,
    -2.46156122e-04, -2.16054156e-04, -1.86952939e-04, -1.58874677e-04,
    -1.31839424e-04, -1.05863296e-04, -8.09585042e-05, -5.71344542e-05,
    -3.43975013e-05, -1.27507819e-05,  7.80555006e-06,  2.72742968e-05,
     4.56606763e-05,  6.29726373e-05,  7.92202420e-05,  9.44163498e-05,
     1.08575385e-04,  1.21714575e-04,  1.33852391e-04,  1.45008776e-04,
     1.55206978e-04,  1.64469490e-04,  1.72821508e-04,  1.80289157e-04,
     1.86900042e-04,  1.92682169e-04,  1.97664675e-04,  2.01877203e-04,
     2.05350374e-04,  2.08115089e-04,  2.10202835e-04,  2.11645062e-04,
     2.12473874e-04,  2.12720312e-04,  2.12417879e-04,  2.11596442e-04,
     2.10288483e-04,  2.08525640e-04,  2.06338547e-04,  2.03757482e-04,
     2.00812464e-04,  1.97533037e-04,  1.93948182e-04,  1.90085937e-04,
     1.85973795e-04,  1.81638120e-04,  1.77105100e-04,  1.72399071e-04,
     1.67545339e-04,  1.62565452e-04,  1.57482521e-04,  1.52319084e-04,
     1.47092877e-04,  1.41824750e-04,  1.36532404e-04,  1.31234099e-04,
     1.25945239e-04,  1.20681679e-04,  1.15457023e-04,  1.10285229e-04,
     1.05178174e-04,  1.00147707e-04,  9.52039620e-05,  9.03565323e-05,
     8.56133789e-05,  8.09851099e-05,  7.64725159e-05,  7.20875527e-05,
     6.78328014e-05,  6.37139481e-05,  5.97326216e-05,  5.58936478e-05,
     5.21977287e-05,  4.86485019e-05,  4.52450451e-05,  4.19898561e-05,
     3.88804249e-05,  3.59187691e-05,  3.31004668e-05,  3.04292683e-05,
     2.78936549e-05,  2.55036495e-05,  2.32497674e-05,  2.11275577e-05,
     1.91356900e-05,  1.72715427e-05,  1.55304891e-05,  1.39097752e-05,
     1.24030480e-05,  1.10084312e-05,  9.71829804e-06,  8.53241106e-06,
     7.44095236e-06,  6.44695233e-06,  5.53421200e-06,  4.71724754e-06,
     3.97842068e-06,  3.29552735e-06,  2.70357144e-06,  2.17222699e-06,
     1.70887208e-06,  1.29864137e-06,  9.46012881e-07,  6.40157722e-07,
     3.84362202e-07,  1.69545575e-07, -1.65670499e-09, -1.37315456e-07,
    -2.35039363e-07, -3.02156487e-07, -3.36087203e-07, -7.52567224e-06]
}

pub fn fir_coeffs4()->Vec<f32>{
    vec![-0.0015384282606607496,0.0006358545316990506,0.0005248073829637525,0.00043570443030781247,0.0003673387837350463,0.0003120769038340999,0.00027055242870854747,0.00023656942484188395,0.0002119279095626511,0.00019132998019970229,0.00017732076600830682,0.00016514318919444893,0.00015783540385035642,0.00015095127626176355,0.00014788278909999238,0.00014431617018780115,0.00014395950210283992,0.00014247749720833701,0.0001435913786191254,0.0001445446664084843,0.00014428212904251964,0.00014839999239386133,0.00014987278728783595,0.00015017311753977932,0.00015423220318602532,0.00015704462074823586,0.00016042799384778194,0.00016162770409012205,0.00016498610569665975,0.00016742937933598057,0.00017190306095980312,0.00017440739383912094,0.0001782117086488598,0.0001800170836371547,0.00018369829248621118,0.00018587760629535277,0.00019017427087271292,0.00019275912428205083,0.00019690858912092281,0.00019958100865968115,0.0002027053247741317,0.00020547061100348448,0.000208886910079042,0.00021081372472363529,0.00021508667049439933,0.0002176666442254187,0.00022147942864255798,0.0002236803013603596,0.00022773755082519773,0.00022996671494832023,0.00023352119116629394,0.0002352289186724583,0.00023879756517073835,0.0002408519136695216,0.0002446757377072076,0.00024663194352422336,0.00025025268339671385,0.00025214266556817665,0.0002557013395983719,0.0002578244564787381,0.0002609665030405589,0.0002628525942159252,0.00026585231419834856,0.0002671324705872788,0.00027034704900727544,0.0002718923285526722,0.00027490583548789,0.0002763466382817545,0.00027947692779022645,0.0002807545817702182,0.00028352824231045763,0.000284660606892495,0.0002875385548095112,0.00028862102113775233,0.0002911949747513502,0.000291895673380717,0.0002942525404567595,0.00029487396537097367,0.0002969916353124818,0.0002975404218594742,0.00029939643096666465,0.0002999486986238983,0.00030196289270760187,0.00030222122855249104,0.00030409483295467917,0.00030414936618039555,0.00030561999142447813,0.0003054905754444029,0.0003069897227752326,0.00030667291088375776,0.00030782600849308143,0.0003072647110872167,0.000308260627009238,0.0003074250575463113,0.00030812292371862966,0.00030707565794070774,0.00030762198579628954,0.00030638097611026464,0.00030656344725982763,0.00030518966916568704,0.00030522148166110363,0.0003037707084554118,0.0003037201978963091,0.00030185053349948004,0.0003015176517567255,0.00029944259045644396,0.0002987740114471964,0.00029642018995219583,0.0002955596440507222,0.0002929112652611508,0.0002917574286147107,0.000288931475730263,0.00028757804757082546,0.00028437758101391855,0.0002826463179306704,0.00027918563861956624,0.0002772455719841033,0.00027356048283844387,0.0002712738466084869,0.00026738514424593115,0.0002648105597785361,0.0002606088047081522,0.0002578099377453134,0.00025330890168577037,0.0002503553332905788,0.0002457134291127285,0.00024242389372309322,0.00023743646264780607,0.0002338992289092417,0.00022862168004130542,0.00022477116234499999,0.00021921609108767727,0.0002150627869434668,0.00020914188574990044,0.00020470363122022332,0.00019858209138381207,0.00019389365470399685,0.00018748036632956094,0.0001824355506688895,0.00017580440380571293,0.00017046803412296857,0.00016347469501997044,0.00015784459610045554,0.00015051862168134213,0.00014463464001623818,0.000137091830215396,0.00013090077770605362,0.00012308080232061448,0.00011667003956928354,0.0001085443556324546,0.00010179108768519716,9.340777791828057e-05,8.645278218300141e-05,7.783805411730785e-05,7.065941945838062e-05,6.181070670895853e-05,5.432603241069798e-05,4.5199740956984244e-05,3.744043446309822e-05,2.813743538717067e-05,2.0117911473571583e-05,1.0493498908762918e-05,2.250861702395718e-06,-7.604615173214483e-06,-1.606772044917995e-05,-2.6128930759185482e-05,-3.4845832566685444e-05,-4.511507645773194e-05,-5.3983493065037436e-05,-6.446489517989199e-05,-7.3571762761954e-05,-8.423570207257173e-05,-9.351748243700158e-05,-0.00010441271672032037,-0.00011390970891183953,-0.000124978537662523,-0.0001346787341533378,-0.00014591950799836516,-0.0001558186629015861,-0.00016719504460763288,-0.00017725050571112543,-0.0001887794328405733,-0.00019890002872765536,-0.00021055053676197525,-0.00022085697359743267,-0.00023266757291871007,-0.0002431199350399916,-0.0002550196217441299,-0.0002655249822471383,-0.0002775245288667136,-0.00028813825774309603,-0.00030019282832660643,-0.0003108618070742698,-0.0003230235243513969,-0.000333777008980849,-0.0003459744198577785,-0.00035679529285313327,-0.00036903054997836256,-0.0003799067659721301,-0.00039214460796799765,-0.0004030376895104819,-0.000415305393412964,-0.00042616653815757575,-0.0004384221120996162,-0.00044928658581363796,-0.0004614836017543852,-0.0004722913862096722,-0.00048444280999724275,-0.0004952004662459671,-0.0005073004218632147,-0.0005179771046091455,-0.0005299557599901944,-0.0005405401275190031,-0.0005524772349149681,-0.0005629822987330657,-0.000574773412048524,-0.000585159295067441,-0.0005968023871380009,-0.0006070549999770392,-0.000618528804239665,-0.0006286255473683974,-0.0006399526842501488,-0.0006498424910361192,-0.000660956252615668,-0.0006706434462316676,-0.0006815057094321504,-0.0006909530033774418,-0.0007015943692373337,-0.0007108073166598771,-0.0007212002261173605,-0.0007301564279643975,-0.0007402713711697987,-0.0007489462729544281,-0.0007587716765507051,-0.0007671088386710099,-0.0007765673099180879,-0.0007846031797978008,-0.0007937355017653789,-0.0008014311578368549,-0.000810180510736614,-0.0008175076845579486,-0.0008259089279472791,-0.0008328507266319287,-0.0008408537897938266,-0.0008474054114606974,-0.000854963990833867,-0.0008610674802049839,-0.0008681876013190558,-0.0008738378663042253,-0.0008804889298416917,-0.000885670954380765,-0.0008918321294351316,-0.0008965073272180848,-0.000902151976608078,-0.000906295877875294,-0.0009113974418928496,-0.0009150442924433068,-0.0009195984507837348,-0.0009226791862273747,-0.0009266534572677479,-0.0009291702764623569,-0.0009325763586240064,-0.0009344782955535676,-0.0009372614113568377,-0.0009385793979916591,-0.0009407507840227024,-0.0009414474993933867,-0.0009429881207249074,-0.0009430257347862916,-0.0009438874356593266,-0.0009432599904118275,-0.0009434516229744464,-0.0009421435612568638,-0.000941645572249513,-0.0009396391420137705,-0.0009384164644668264,-0.000935713799596567,-0.0009337506880525263,-0.0009303083863644878,-0.0009276061826669977,-0.0009234242325617677,-0.0009199624774109678,-0.0009149962768613224,-0.0009107600588178779,-0.0009050592245521108,-0.0009000444793416751,-0.0008935423617665473,-0.0008877256302194329,-0.0008804148815410038,-0.0008737719921368373,-0.0008656384867145326,-0.000858161452751719,-0.0008491874953768671,-0.0008408779757220644,-0.0008310836528847506,-0.0008219262227878088,-0.000811301151786696,-0.0008012731844196598,-0.0007897866317019273,-0.0007789073992823718,-0.0007665698586229459,-0.0007548252657650402,-0.000741610262881454,-0.0007289838928365836,-0.00071490268094088,-0.0007013668977289039,-0.0006863797169215885,-0.0006719656437454361,-0.0006561059077866847,-0.0006407904246460289,-0.0006240305274238596,-0.0006078156278143813,-0.0005901589685646162,-0.000573048246008411,-0.0005545008402538167,-0.0005364671526431554,-0.0005170240901621701,-0.0004980771568879338,-0.00047773678673935474,-0.00045789515181540816,-0.0004366545526786527,-0.0004159061087199989,-0.0003937685287839134,-0.000372122929020732,-0.00034909997547134786,-0.0003265357919333741,-0.00030260597826422685,-0.000279161210261559,-0.00025435608711996496,-0.00023001423403610664,-0.00020432988412167306,-0.00017911671101799903,-0.00015255047298868836,-0.00012644201224462095,-9.899724927632915e-05,-7.200307075712624e-05,-4.3715515179716105e-05,-1.5866145337425268e-05,1.3271322322773536e-05,4.197197164481411e-05,7.195468957196588e-05,0.00010149513692744947,0.0001322983312817415,0.00016266548052308073,0.00019428110542474503,0.00022547393464736028,0.0002578923636336794,0.0002898704090094498,0.000323074428196364,0.00035585524664904665,0.0003898295334579308,0.000423362981301153,0.0004580933991128579,0.0004923893552034341,0.0005278514321573359,0.0005628870625645455,0.000599060370527315,0.0006348198334259938,0.0006717024419399639,0.0007081570214680097,0.000745721706646029,0.0007828589611000056,0.0008210863616763442,0.0008588821371472849,0.0008977329991457133,0.0009361460496806438,0.0009755959430014871,0.0010146057382178686,0.001054651888680135,0.0010942604673851166,0.0011348647623912952,0.0011750153129193117,0.0012161631310441082,0.0012568556974561277,0.001298500745948785,0.0013396995587690896,0.0013818294284040189,0.001423517919071847,0.0014661118349491601,0.0015082432277455792,0.0015512624870112313,0.0015938169557937895,0.001637229417284268,0.001680172029458346,0.0017239440522240465,0.0017672466373647479,0.0018113590622685465,0.0018549887106459554,0.0018994069049205278,0.001943336781711074,0.0019880262592633004,0.0020322184737987074,0.002077160089173114,0.002121586243284674,0.0021667087179506068,0.0022113312251173904,0.0022566335874343512,0.002301427671322381,0.002346867201210636,0.00239177806660856,0.002437319153369414,0.0024823264820756077,0.0025279291845971535,0.002572994227342193,0.0026186307707412658,0.0026637263870791478,0.002709363535361352,0.002754439776724424,0.002800029170135346,0.002845051939212823,0.002890562109765397,0.0029354947563733596,0.0029809007543991875,0.0030257203041650915,0.0030709690224285653,0.0031156445867471915,0.0031607158706773468,0.0032051888682150783,0.003250027298908918,0.0032942644556387297,0.0033388536460356505,0.0033828259157378214,0.003427106389548131,0.003470767020182412,0.0035147171783733496,0.0035580414391574904,0.0036016223436314393,0.0036445620030056414,0.003687732237028394,0.00373025438992229,0.0037729798956250226,0.0038150422988906954,0.003857291823799376,0.0038988731248150673,0.003940598037129244,0.003981660446419244,0.004022831279001169,0.004063318895821475,0.004103895926015134,0.004143791861756463,0.00418375474113044,0.004223019866726244,0.004262318828763476,0.00430092509086066,0.0043395395554262925,0.00437744104275268,0.004415316618781231,0.004452480239160539,0.004489601563736841,0.0045260034038310925,0.004562329761644942,0.004597918917592252,0.00463341379439056,0.004668172577162853,0.004702799008449205,0.0047366989525042666,0.004770442130316495,0.004803445227667011,0.00483627498520619,0.004868362979385294,0.004900249343290854,0.004931382804117443,0.004962290946495571,0.004992450448714155,0.005022354545125749,0.005051492586289948,0.005080356510875489,0.005108465915858355,0.005136281315090542,0.005163328569126282,0.005190058022731104,0.005216016662897657,0.005241640641928993,0.005266492653270927,0.005290968730348477,0.005314685454791633,0.005338014949154448,0.005360579392573688,0.005382740471256173,0.00540413332014944,0.005425094491362224,0.0054452860855153246,0.005465031800971654,0.005484018601960294,0.005502535593727144,0.005520288427768081,0.0055375588871327,0.005554072219663355,0.005570075795479872,0.005585312666049209,0.005600033988452909,0.005613997456686215,0.005627425079063119,0.005640097366679923,0.005652204381483139,0.005663577217856768,0.005674377183059933,0.0056844328266293775,0.005693902081419085,0.005702635719116847,0.005710769603409853,0.005718173418483771,0.0057249635021373695,0.005731032003200537,0.005736469098299554,0.0057411931874680865,0.005745280236749907,0.005748661705415336,0.005751381794501155,0.005753397134412384,0.00575475888511646,0.005755431188983781,0.005755431188983781,0.00575475888511646,0.005753397134412384,0.005751381794501155,0.005748661705415336,0.005745280236749907,0.0057411931874680865,0.005736469098299554,0.005731032003200537,0.0057249635021373695,0.005718173418483771,0.005710769603409853,0.005702635719116847,0.005693902081419085,0.0056844328266293775,0.005674377183059933,0.005663577217856768,0.005652204381483139,0.005640097366679923,0.005627425079063119,0.005613997456686215,0.005600033988452909,0.005585312666049209,0.005570075795479872,0.005554072219663355,0.0055375588871327,0.005520288427768081,0.005502535593727144,0.005484018601960294,0.005465031800971654,0.0054452860855153246,0.005425094491362224,0.00540413332014944,0.005382740471256173,0.005360579392573688,0.005338014949154448,0.005314685454791633,0.005290968730348477,0.005266492653270927,0.005241640641928993,0.005216016662897657,0.005190058022731104,0.005163328569126282,0.005136281315090542,0.005108465915858355,0.005080356510875489,0.005051492586289948,0.005022354545125749,0.004992450448714155,0.004962290946495571,0.004931382804117443,0.004900249343290854,0.004868362979385294,0.00483627498520619,0.004803445227667011,0.004770442130316495,0.0047366989525042666,0.004702799008449205,0.004668172577162853,0.00463341379439056,0.004597918917592252,0.004562329761644942,0.0045260034038310925,0.004489601563736841,0.004452480239160539,0.004415316618781231,0.00437744104275268,0.0043395395554262925,0.00430092509086066,0.004262318828763476,0.004223019866726244,0.00418375474113044,0.004143791861756463,0.004103895926015134,0.004063318895821475,0.004022831279001169,0.003981660446419244,0.003940598037129244,0.0038988731248150673,0.003857291823799376,0.0038150422988906954,0.0037729798956250226,0.00373025438992229,0.003687732237028394,0.0036445620030056414,0.0036016223436314393,0.0035580414391574904,0.0035147171783733496,0.003470767020182412,0.003427106389548131,0.0033828259157378214,0.0033388536460356505,0.0032942644556387297,0.003250027298908918,0.0032051888682150783,0.0031607158706773468,0.0031156445867471915,0.0030709690224285653,0.0030257203041650915,0.0029809007543991875,0.0029354947563733596,0.002890562109765397,0.002845051939212823,0.002800029170135346,0.002754439776724424,0.002709363535361352,0.0026637263870791478,0.0026186307707412658,0.002572994227342193,0.0025279291845971535,0.0024823264820756077,0.002437319153369414,0.00239177806660856,0.002346867201210636,0.002301427671322381,0.0022566335874343512,0.0022113312251173904,0.0021667087179506068,0.002121586243284674,0.002077160089173114,0.0020322184737987074,0.0019880262592633004,0.001943336781711074,0.0018994069049205278,0.0018549887106459554,0.0018113590622685465,0.0017672466373647479,0.0017239440522240465,0.001680172029458346,0.001637229417284268,0.0015938169557937895,0.0015512624870112313,0.0015082432277455792,0.0014661118349491601,0.001423517919071847,0.0013818294284040189,0.0013396995587690896,0.001298500745948785,0.0012568556974561277,0.0012161631310441082,0.0011750153129193117,0.0011348647623912952,0.0010942604673851166,0.001054651888680135,0.0010146057382178686,0.0009755959430014871,0.0009361460496806438,0.0008977329991457133,0.0008588821371472849,0.0008210863616763442,0.0007828589611000056,0.000745721706646029,0.0007081570214680097,0.0006717024419399639,0.0006348198334259938,0.000599060370527315,0.0005628870625645455,0.0005278514321573359,0.0004923893552034341,0.0004580933991128579,0.000423362981301153,0.0003898295334579308,0.00035585524664904665,0.000323074428196364,0.0002898704090094498,0.0002578923636336794,0.00022547393464736028,0.00019428110542474503,0.00016266548052308073,0.0001322983312817415,0.00010149513692744947,7.195468957196588e-05,4.197197164481411e-05,1.3271322322773536e-05,-1.5866145337425268e-05,-4.3715515179716105e-05,-7.200307075712624e-05,-9.899724927632915e-05,-0.00012644201224462095,-0.00015255047298868836,-0.00017911671101799903,-0.00020432988412167306,-0.00023001423403610664,-0.00025435608711996496,-0.000279161210261559,-0.00030260597826422685,-0.0003265357919333741,-0.00034909997547134786,-0.000372122929020732,-0.0003937685287839134,-0.0004159061087199989,-0.0004366545526786527,-0.00045789515181540816,-0.00047773678673935474,-0.0004980771568879338,-0.0005170240901621701,-0.0005364671526431554,-0.0005545008402538167,-0.000573048246008411,-0.0005901589685646162,-0.0006078156278143813,-0.0006240305274238596,-0.0006407904246460289,-0.0006561059077866847,-0.0006719656437454361,-0.0006863797169215885,-0.0007013668977289039,-0.00071490268094088,-0.0007289838928365836,-0.000741610262881454,-0.0007548252657650402,-0.0007665698586229459,-0.0007789073992823718,-0.0007897866317019273,-0.0008012731844196598,-0.000811301151786696,-0.0008219262227878088,-0.0008310836528847506,-0.0008408779757220644,-0.0008491874953768671,-0.000858161452751719,-0.0008656384867145326,-0.0008737719921368373,-0.0008804148815410038,-0.0008877256302194329,-0.0008935423617665473,-0.0009000444793416751,-0.0009050592245521108,-0.0009107600588178779,-0.0009149962768613224,-0.0009199624774109678,-0.0009234242325617677,-0.0009276061826669977,-0.0009303083863644878,-0.0009337506880525263,-0.000935713799596567,-0.0009384164644668264,-0.0009396391420137705,-0.000941645572249513,-0.0009421435612568638,-0.0009434516229744464,-0.0009432599904118275,-0.0009438874356593266,-0.0009430257347862916,-0.0009429881207249074,-0.0009414474993933867,-0.0009407507840227024,-0.0009385793979916591,-0.0009372614113568377,-0.0009344782955535676,-0.0009325763586240064,-0.0009291702764623569,-0.0009266534572677479,-0.0009226791862273747,-0.0009195984507837348,-0.0009150442924433068,-0.0009113974418928496,-0.000906295877875294,-0.000902151976608078,-0.0008965073272180848,-0.0008918321294351316,-0.000885670954380765,-0.0008804889298416917,-0.0008738378663042253,-0.0008681876013190558,-0.0008610674802049839,-0.000854963990833867,-0.0008474054114606974,-0.0008408537897938266,-0.0008328507266319287,-0.0008259089279472791,-0.0008175076845579486,-0.000810180510736614,-0.0008014311578368549,-0.0007937355017653789,-0.0007846031797978008,-0.0007765673099180879,-0.0007671088386710099,-0.0007587716765507051,-0.0007489462729544281,-0.0007402713711697987,-0.0007301564279643975,-0.0007212002261173605,-0.0007108073166598771,-0.0007015943692373337,-0.0006909530033774418,-0.0006815057094321504,-0.0006706434462316676,-0.000660956252615668,-0.0006498424910361192,-0.0006399526842501488,-0.0006286255473683974,-0.000618528804239665,-0.0006070549999770392,-0.0005968023871380009,-0.000585159295067441,-0.000574773412048524,-0.0005629822987330657,-0.0005524772349149681,-0.0005405401275190031,-0.0005299557599901944,-0.0005179771046091455,-0.0005073004218632147,-0.0004952004662459671,-0.00048444280999724275,-0.0004722913862096722,-0.0004614836017543852,-0.00044928658581363796,-0.0004384221120996162,-0.00042616653815757575,-0.000415305393412964,-0.0004030376895104819,-0.00039214460796799765,-0.0003799067659721301,-0.00036903054997836256,-0.00035679529285313327,-0.0003459744198577785,-0.000333777008980849,-0.0003230235243513969,-0.0003108618070742698,-0.00030019282832660643,-0.00028813825774309603,-0.0002775245288667136,-0.0002655249822471383,-0.0002550196217441299,-0.0002431199350399916,-0.00023266757291871007,-0.00022085697359743267,-0.00021055053676197525,-0.00019890002872765536,-0.0001887794328405733,-0.00017725050571112543,-0.00016719504460763288,-0.0001558186629015861,-0.00014591950799836516,-0.0001346787341533378,-0.000124978537662523,-0.00011390970891183953,-0.00010441271672032037,-9.351748243700158e-05,-8.423570207257173e-05,-7.3571762761954e-05,-6.446489517989199e-05,-5.3983493065037436e-05,-4.511507645773194e-05,-3.4845832566685444e-05,-2.6128930759185482e-05,-1.606772044917995e-05,-7.604615173214483e-06,2.250861702395718e-06,1.0493498908762918e-05,2.0117911473571583e-05,2.813743538717067e-05,3.744043446309822e-05,4.5199740956984244e-05,5.432603241069798e-05,6.181070670895853e-05,7.065941945838062e-05,7.783805411730785e-05,8.645278218300141e-05,9.340777791828057e-05,0.00010179108768519716,0.0001085443556324546,0.00011667003956928354,0.00012308080232061448,0.00013090077770605362,0.000137091830215396,0.00014463464001623818,0.00015051862168134213,0.00015784459610045554,0.00016347469501997044,0.00017046803412296857,0.00017580440380571293,0.0001824355506688895,0.00018748036632956094,0.00019389365470399685,0.00019858209138381207,0.00020470363122022332,0.00020914188574990044,0.0002150627869434668,0.00021921609108767727,0.00022477116234499999,0.00022862168004130542,0.0002338992289092417,0.00023743646264780607,0.00024242389372309322,0.0002457134291127285,0.0002503553332905788,0.00025330890168577037,0.0002578099377453134,0.0002606088047081522,0.0002648105597785361,0.00026738514424593115,0.0002712738466084869,0.00027356048283844387,0.0002772455719841033,0.00027918563861956624,0.0002826463179306704,0.00028437758101391855,0.00028757804757082546,0.000288931475730263,0.0002917574286147107,0.0002929112652611508,0.0002955596440507222,0.00029642018995219583,0.0002987740114471964,0.00029944259045644396,0.0003015176517567255,0.00030185053349948004,0.0003037201978963091,0.0003037707084554118,0.00030522148166110363,0.00030518966916568704,0.00030656344725982763,0.00030638097611026464,0.00030762198579628954,0.00030707565794070774,0.00030812292371862966,0.0003074250575463113,0.000308260627009238,0.0003072647110872167,0.00030782600849308143,0.00030667291088375776,0.0003069897227752326,0.0003054905754444029,0.00030561999142447813,0.00030414936618039555,0.00030409483295467917,0.00030222122855249104,0.00030196289270760187,0.0002999486986238983,0.00029939643096666465,0.0002975404218594742,0.0002969916353124818,0.00029487396537097367,0.0002942525404567595,0.000291895673380717,0.0002911949747513502,0.00028862102113775233,0.0002875385548095112,0.000284660606892495,0.00028352824231045763,0.0002807545817702182,0.00027947692779022645,0.0002763466382817545,0.00027490583548789,0.0002718923285526722,0.00027034704900727544,0.0002671324705872788,0.00026585231419834856,0.0002628525942159252,0.0002609665030405589,0.0002578244564787381,0.0002557013395983719,0.00025214266556817665,0.00025025268339671385,0.00024663194352422336,0.0002446757377072076,0.0002408519136695216,0.00023879756517073835,0.0002352289186724583,0.00023352119116629394,0.00022996671494832023,0.00022773755082519773,0.0002236803013603596,0.00022147942864255798,0.0002176666442254187,0.00021508667049439933,0.00021081372472363529,0.000208886910079042,0.00020547061100348448,0.0002027053247741317,0.00019958100865968115,0.00019690858912092281,0.00019275912428205083,0.00019017427087271292,0.00018587760629535277,0.00018369829248621118,0.0001800170836371547,0.0001782117086488598,0.00017440739383912094,0.00017190306095980312,0.00016742937933598057,0.00016498610569665975,0.00016162770409012205,0.00016042799384778194,0.00015704462074823586,0.00015423220318602532,0.00015017311753977932,0.00014987278728783595,0.00014839999239386133,0.00014428212904251964,0.0001445446664084843,0.0001435913786191254,0.00014247749720833701,0.00014395950210283992,0.00014431617018780115,0.00014788278909999238,0.00015095127626176355,0.00015783540385035642,0.00016514318919444893,0.00017732076600830682,0.00019132998019970229,0.0002119279095626511,0.00023656942484188395,0.00027055242870854747,0.0003120769038340999,0.0003673387837350463,0.00043570443030781247,0.0005248073829637525,0.0006358545316990506, -0.0015384282606607496]
}